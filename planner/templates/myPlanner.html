{% extends "layout.html" %}

{% block content %}

<!--Courses per term-->
<div class="container-fluid">
	<h2 class="mb-3">Courses per term</h2>
	<div class="row flex-nowrap overflow-scroll pt-3">
		{% for collection in courseCollections %}
		<div class="col-3 mx-2 p-0">
			<div class="card h-100">
				{% if not (collection.transfer or collection.userCourses) %}
				<form action="/my/del/collection" method="POST">
					<input type="hidden" name="id" value="{{collection.id}}">
					<button
						class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-light border border-secondary">
						<i class="bi-x-lg text-secondary"></i>
						<span class="visually-hidden">Remove term</span>
					</button>
				</form>
				{% endif %}
				<div class="card-header text-center">
					{% if collection.transfer %}
					<span class="h5">Transfered</span>
					{% else %}
					<span class="h5">{{collection.term.season.name | capitalize}} {{collection.term.year}}</span>
					<br>
					<small class="m-0 text-muted"><i>{{collection.term.start}} > {{collection.term.end}}</i></small>
					{% endif %}
				</div>
				<div class="course-container card-body p-1" db-id="{{collection.id}}">
					{% for uCourse in collection.userCourses %}
					<div class="course-item m-1 btn bg-light card" db-id="{{uCourse.id}}" db-passed="{{uCourse.passed | tojson | safe}}" draggable="true"
						data-bs-toggle="modal" data-bs-target="#modalEditUserCourse">
						<div class="row">
							<span class="col-3">&#{{uCourse.course.getEmoji()}}</span>
							<span id="code"
								class="col-6 mono-font">{{uCourse.course.subject.code}}-{{uCourse.course.code}}</span>
							<span class="col-3 mono-font text-start">
								{% if uCourse.gradeLetter %}
								{{uCourse.gradeLetter}}
								{% else %}
								-
								{% endif %}
							</span>
						</div>
					</div>
					{% endfor %}
				</div>
				<div class="card-footer">
					<div class="row">
						<span class="col-9 text-center">Term GPA</span>
						<span class="col-3 mono-font text-start">{{collection.getGPA()}}</span>
					</div>
				</div>
			</div>
		</div>
		{% endfor %}
		<div class="col-2 card mx-2 p-0" data-bs-toggle="modal" data-bs-target="#modalAddCollection">
			<div class="card-body btn btn-light">
				<div class="h-100 d-flex flex-column align-content-center text-muted">
					<div class="mt-auto"><i class="bi-plus-lg display-4"></i></div>
					<div class="h5 mb-auto">Add term</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!--Form modal-->

<!--Form add CourseCollection-->
<form id="formAddCollection" name="formAddCollection" action="/my/add/collection" method="POST">
	<div class="modal fade" id="modalAddCollection" tabindex="-1" aria-labelledby="exampleModalLabel"
		aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Add term</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body px-5">
					<div class="row g-2">
						<div class="col-md">
							<div class="form-floating">
								<select class="form-select" id="selectSeason" name="season" aria-label="Select season">
									{% for season in seasons %}
									<option value="{{season.id}}">{{season.name | capitalize}}</option>
									{% endfor %}
								</select>
								<label for="selectSeason">Season</label>
							</div>
						</div>
						<div class="col-md">
							<div class="form-floating">
								<select class="form-select" id="selectYear" name="year" aria-label="Select year">
									{% for year in years %}
									<option value="{{year}}">{{year}}</option>
									{% endfor %}
								</select>
								<label for="selectYear">Year</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer d-flex justify-content-around">
					<button type="submit" class="btn btn-primary">Add</button>
				</div>
			</div>
		</div>
	</div>
</form>

<!--Form edit UserCourse-->
<form id="formEditUserCourse" name="formEditUserCourse" action="/my/edit/course" method="POST">
	<div class="modal fade" id="modalEditUserCourse" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Edit course</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body px-5">
					<div class="row mb-2">
						<label for="selectCoursePlaceholder" class="col-3 col-form-label">Course</label>
						<div class="col-9">
							<input type="hidden" id="selectCourse" name="id" value="">
							<input type="text" id="selectCoursePlaceholder" class="form-control col-9" value=""
								disabled readonly>
						</div>
					</div>
					<div class="row">
						<label class="col-3 col-form-label" for="selectCollection">Term</label>
						<div class="col-9">
							<select class="form-select" aria-label="Select term" name="collection_id"
								id="selectCollection">
								{% for collection in courseCollections %}
								<option value="{{collection.id}}">
									{% if collection.transfer %}
									Transferred
									{% else %}
									{{collection.term.season.name | capitalize}} {{collection.term.year}}
									{% endif %}
								</option>
								{% endfor %}
							</select>
						</div>
					</div>
					<div class="row">
						<label class="col-3 col-form-label">Passed</label>
						<div class="col-9 py-2">
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="passed" id="selectPassedTrue" value="true">
								<label class="form-check-label" for="selectPassedTrue">Yes</label>
							</div>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="passed" id="selectPassedFalse"
									value="false">
								<label class="form-check-label" for="selectPassedFalse">No</label>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer d-flex justify-content-around">
					<button type="submit" class="btn btn-primary">Save changes</button>
				</div>
			</div>
		</div>
	</div>
</form>

<script src="/static/scripts/planner.js"></script>

{% include "components/error.html" %}

{% endblock %}